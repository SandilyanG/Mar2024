My revised code to be uploaded.
